---
title: "Commission on Investing in Health: Analysis Outputs"
author: "William Msemburi"
date: "2025"
output:
  rmdformats::material:
  highlight: kate
runtime: shiny
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(DiagrammeR)
library(DiagrammeRsvg)
library(htmltools)
library(highcharter)
library(tidyr)
library(dplyr)
library(rmdformats)
library(shiny)
library(shinythemes)
library(shinydashboard)
library(shinycssloaders)

load("plots.Rda")
```

# Introduction

Reducing premature mortality remains a central aim of global health policy. A key metric for monitoring this goal is the probability of death between birth and age 70 ($_{70}q_0$), which serves as a summary indicator of survival across early and middle adulthood. Despite considerable progress over recent decades, large disparities in mortality rates persist between countries, driven by unequal access to health services, differences in socioeconomic conditions, and variations in disease burden.

Building on the work of Norheim et al. (2024), who demonstrated the feasibility of halving 70q0 by 2050, this study expands the analysis to examine the health and economic implications of scaling up more than 120 proven health interventions across 199 countries. Our approach explicitly integrates age-specific death rates as the primary outcome of interest, which are used to simulate population dynamics through cohort component projection models.

From these age-specific death rates, we construct life tables to estimate annual survivors and deaths by age and sex. These deaths are disaggregated by cause using the Global Burden of Disease (GBD 2021) framework, and are used to calculate 70q0 and assess the impact of intervention scale-up. Cost and mortality effects are estimated using the FairChoices Disease Control Priorities (DCP) analytics tool, enabling the calculation of incremental cost-effectiveness ratios (ICERs) and disease-specific decompositions.

By linking age-structured mortality, cause-specific attribution, and cost-effectiveness in a single analytic framework, this study aims to provide globally comparable estimates of the mortality and financial gains achievable through targeted intervention scale-up from 2025 to 2050.

# Methods

The analytic workflow — including demographic modeling, mortality estimation, intervention scale-up, and cost-effectiveness — is shown in the diagram below.

```{r diagram-ccpm-vertical-aligned, results='asis', echo=FALSE, message=FALSE}
svg.out <- grViz("
digraph framework {
  graph [layout = dot, rankdir = TB]
  node [shape = box, style = filled, fillcolor = azure, fontname = Helvetica, fontsize = 10]

  // Inputs
  A1 [label='WPP 2024:\\nPopulation, Mortality,\\nFertility, Migration']
  A2 [label='GBD 2021:\\nCause-specific Mortality,\\nIncidence, Prevalence']
  A3 [label='FairChoices Tool:\\nBaseline Coverage,\\nMortality Impact, Costs']

  // Scenarios
  S1 [label='Scenario A:\\nBaseline Coverage \\n(Baseline Mortality)']
  S2 [label='Scenario B:\\nScale-up to 95%\\n(Reduced Mortality)']

  // CCPMs
  C1 [label='CCPM:\\nBaseline Scenario']
  C2 [label='CCPM:\\nScale-up Scenario']

  // Subgraph to align Costs horizontally
  { rank = same; D1 [label='Costs:\\nScenario A']; D2 [label='Costs:\\nScenario B'] }

  // Subgraph to align Deaths horizontally
  { rank = same; E1 [label='Deaths by Age, Sex,\\nYear, Country, Cause\\n(Scenario A)'];
                 E2 [label='Deaths by Age, Sex,\\nYear, Country, Cause\\n(Scenario B)'] }

  // 70q0 outcomes
  F1 [label='₇₀q₀:\\nScenario A']
  F2 [label='₇₀q₀:\\nScenario B']

  // Final analysis
  G [label='Analysis']
  G1 [label='Country/Region Progress\\nReducing ₇₀q₀']
  G2 [label='ICER = ΔCost / Δ(1 - ₇₀q₀)']
  G3 [label='Decomposition:\\nReduction in ₇₀q₀ by Cause']

  // Edges
  A1 -> S1; A1 -> S2
  A2 -> S1; A2 -> S2
  A3 -> S1; A3 -> S2

  S1 -> C1
  S2 -> C2

  C1 -> D1; C1 -> E1
  C2 -> D2; C2 -> E2

  E1 -> F1
  E2 -> F2

  F1 -> G
  F2 -> G
  D1 -> G
  D2 -> G

  G -> G1
  G -> G2
  G -> G3
}
") %>%
  export_svg()

browsable(HTML(
  paste0('<div style="display: flex; justify-content: center;">',
         '<div style="max-width: 1000px;">', svg.out, '</div></div>')
))
```

# Regional view

***

**Global Regional Health and Economic Indicators, 2023**

This interactive map displays ten global regions, color-coded to distinguish geographical areas spanning 195 countries. Each region is labeled with three key indicators: population size (POP, in millions), the probability of premature death before age 70 (PPD, expressed as a percentage), and gross national income per capita (GNI, in current US dollars).

The regions include North Atlantic, Central and Eastern Europe, Central Asia, China, India, Western Pacific and Southeast Asia, Middle East and North Africa, Sub-Saharan Africa, Latin America and Caribbean, and the United States. A legend at the bottom identifies each region by its corresponding color, and global totals are provided below the map showing the world population of 8.0 billion, an overall premature mortality rate of 30.2%, and a global GNI per capita of $12,914.

Users can interact with the map to explore country-level data and export the visualization in multiple formats.

*Data sources: UN Population Division (2023), FairChoices CIH impact (2026)*

```{r map2, echo=FALSE}
browsable(div(intro.map.hc, style = "width: 100%;"))
```

## Indicator and series trend

```{r shinyts, echo=FALSE}
mets   <- unique(df_labeled$metric)
grps   <- unique(df_labeled$grouping)
calibs <- unique(df_labeled$calibration)

shinyApp(
  ui = fluidPage(
    theme = shinytheme("sandstone"),
    fluidRow(
      column(12,
        selectInput("met",   "Indicator:", choices = mets,   selected = "70q0"),
        selectInput("grp",   "Series:",    choices = grps,   selected = grps[1]),
        selectInput("calib", "Source:",    choices = calibs, selected = calibs[1])
      )
    ),
    mainPanel(width = 12,
      fluidRow(column(12, withSpinner(uiOutput("ts.metric"))))
    )
  ),
  server = function(input, output) {
    values <- reactive({
      plot_ts_metric(input$met, input$grp, df_labeled, region_colors, input$calib)
    })
    output$ts.metric <- renderUI({ values() })
  },
  options = list(height = 600)
)
```

# CIH Paper Outputs

*Figure X*. Intervention cost-effectiveness by condition. Each row denotes the range of cost-effectiveness ratios for FairChoices interventions addressing that condition. The left bar denotes the most cost-effective intervention, and the right bar denotes the least cost-effective intervention. The aggregate effect of all interventions within that group is shown as the central dot. Cost-effectiveness ratios are calculated one by one for each intervention (or in the case of the central dot, all interventions addressing that condition) for a standardized 10% increase in coverage sustained over 2025-2050. Results are reported as the aggregate (population-weighted) cost-effectiveness across 195 countries.

```{r fig-x, echo=FALSE}
browsable(div(cih.p1, style = "width: 100%;"))
```

*Figure Y.* Prospects for achieving the 50x50 target, by world region. The plot shows the trend in 70q0 over time by world region, relative to each region's 2019 value for 70q0. The trend assumes that the intervention pathway outlined in the methods section is followed and that the priority interventions are fully implemented by 2050. The dotted line denotes a 70q0 that is 50% lower than the 2019 level; trendlines that cross this threshold indicate the target has been achieved in that region.

```{r fig-y, echo=FALSE}
browsable(div(cih.p2, style = "width: 100%;"))
```

```{r table-a, echo=FALSE}
library(knitr)
library(kableExtra)

deaths.costs.agg %>%
  mutate(
    `Change in 70q0 (2050 vs. 2019)`                          = paste0(round(dq70, 1), "%"),
    `Premature deaths averted (millions)`                     = round(deaths.averted, 1),
    `Cumulative incremental costs (US$, billions)`            = paste0("$", format(round(incremental.cost, 0), big.mark = ",")),
    `Average annual incremental cost as a share of 2023 GNI` = paste0(round(ave.cost.per.gni, 2), "%")
  ) %>%
  select(Region, q70.2019, q70.2050,
         starts_with("Change"), starts_with("Premature"),
         starts_with("Cumulative"), starts_with("Average")) %>%
  rename("70q0 (2019)" = q70.2019, "70q0 (2050)" = q70.2050) %>%
  kable(
    format  = "html",
    caption = "Table A. Overall impact and cost of achieving the 50x50 target, by world region.",
    align   = c("l", "r", "r", "r", "r", "r", "r")
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"),
                full_width = FALSE) %>%
  footnote(general = "Notes: All costs are presented in constant 2023 US dollars.",
           general_title = "")
```

# Country focus on $_{70}q_0$

## Baseline assumptions

```{r map, echo=FALSE}
browsable(div(map1, style = "width: 100%;"))
```

## Progress halving $_{70}q_0$ by country and region

```{r shinyapp, echo=FALSE}
shinyApp(
  ui = fluidPage(
    theme = shinytheme("sandstone"),
    fluidRow(
      column(6,
        selectInput("loc", "Select location:", choices = locs, selected = locs[1])
      )
    ),
    mainPanel(width = 12,
      fluidRow(column(12, withSpinner(uiOutput("trend.q70"))))
    )
  ),
  server = function(input, output) {
    values <- reactive({
      plot.q70.trend(df.is, input$loc)
    })
    output$trend.q70 <- renderUI({ values() })
  },
  options = list(height = 600)
)
```
